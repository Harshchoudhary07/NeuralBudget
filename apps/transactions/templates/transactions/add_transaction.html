{% extends 'core/base.html' %} {% load static %} {% block title %}Add
Transaction | Neural Budget AI{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'transactions/css/add_transaction.css' %}" />
<style>
  .incomeTable tbody {
    display: table-row-group !important;
  }
</style>
{% endblock %} {% block content %}
<section class="add-expense-section">
  <h2>Add Transaction</h2>

  <!-- Transaction Type Toggle -->
  <div class="transaction-type-toggle">
    <button type="button" id="expenseBtn" class="active">
      Expense
    </button>
    <button type="button" id="incomeBtn">
      Income
    </button>
  </div>

  <!-- Entry Type Toggle -->
  <div class="entry-toggle">
    <button type="button" id="manualBtn" class="active">
      Manual Entry
    </button>
    <button type="button" id="ocrBtn">
      Upload Image (OCR)
    </button>
  </div>

  <!-- Manual Entry Form -->
  <form method="POST" enctype="multipart/form-data" class="entry-form" id="manualForm" action="#">
    {% csrf_token %}
    <input type="hidden" id="transaction_type" name="transaction_type" value="expense" />
    <label for="name" id="name_label">Transaction Name:</label>
    <input type="text" id="name" name="name" required />

    <label for="category" id="category_label">Category:</label>
    <select id="category" name="category" required>
      {% for category in categories %}
      <option value="{{ category }}">{{ category }}</option>
      {% endfor %}
      <option value="Other">Other</option>
    </select>

    <div id="other-category-container" style="display: none">
      <label for="other-category">Specify Category:</label>
      <input type="text" id="other-category" name="other_category" />
      <button type="button" id="add-category-btn">Add New Category</button>
    </div>

    <label for="amount">Amount:</label>
    <input type="number" id="amount" name="amount" required />

    <label for="date">Date:</label>
    <input type="date" id="date" name="date" required />

    <label for="status">Status:</label>
    <select id="status" name="status" required>
      <option value="Pending">Pending</option>
      <option value="Completed">Completed</option>
      <option value="Failed">Failed</option>
      <option value="Cancelled">Cancelled</option>
      <option value="Partially Paid">Partially Paid</option>
      <option value="Due">Due</option>
    </select>

    <button type="submit">Submit Expense</button>
  </form>

  <!-- OCR Upload Form -->
  <form method="POST" enctype="multipart/form-data" class="entry-form" id="ocrForm" style="display: none">
    {% csrf_token %}
    <label for="receipt">Upload Receipt:</label>
    <input type="file" id="image" name="image" accept="image/*" required />
    <button type="submit">Upload & Extract</button>
  </form>
  </form>

  <!-- OCR Preview Modal -->
  <div id="ocrPreviewModal" class="modal">
    <div class="modal-content">
      <h3>Confirm Transaction Details</h3>
      <p>Please review the extracted details before adding.</p>

      <form id="previewForm">
        <div>
          <label for="preview-name">Name:</label>
          <input type="text" id="preview-name" name="name">
        </div>

        <div>
          <label for="preview-amount">Amount:</label>
          <input type="number" id="preview-amount" name="amount" step="0.01">
        </div>

        <div>
          <label for="preview-date">Date:</label>
          <input type="date" id="preview-date" name="date">
        </div>

        <div>
          <label for="preview-category">Category:</label>
          <input type="text" id="preview-category" name="category">
        </div>

        <div>
          <label for="preview-status">Status:</label>
          <select id="preview-status" name="status">
            <option value="Pending">Pending</option>
            <option value="Completed">Completed</option>
            <option value="Failed">Failed</option>
            <option value="Cancelled">Cancelled</option>
            <option value="Partially Paid">Partially Paid</option>
            <option value="Due">Due</option>
          </select>
        </div>

        <div class="modal-actions">
          <button type="button" id="cancelPreviewBtn">Cancel</button>
          <button type="submit" id="confirmTransactionBtn">Confirm & Add</button>
        </div>
      </form>
    </div>
  </div>
</section>

<script></script>
{% endblock %} {% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module" src="{% static 'transactions/js/add_transaction.js' %}"></script>
<script type="module" src="{% static 'budgets/js/budget.js' %}"></script>
{% endblock %}